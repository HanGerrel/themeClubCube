"use strict";appMakeBeCool.gateway.addClass("Images",function(e,o,m,p){function r(){if(appMakeBeCool.gateway.base.Class.apply(a,[f]),!i.preloaded)return a.init();a.globals.customCreate=function(){t(),n(),l(),c(),g().generateImages()},a.create()}var a=this,f=o.extend({imgPreloaderWrapClass:"img-preloader-wrap",imgPreloaderClass:"loading",imgPreloadClass:"img-preload",imgDataSrc2x:"data-src2x",imgDataSrc:"data-src",simulatedDelay:2,loaderClass:".loading",loaderTemplate:""},e),i={preloaded:!1},t=function(){},n=function(){},l=function(){s().setGenerateImagesBind()},s=function(){return{setGenerateImagesBind:function(){a.bind(m,a.globals.classType+"_GenerateImages",function(e,a,t){d(a)})}}},g=function(){return{generateImages:function(e){a.trigger(a.globals.classType+"_GenerateImages",e)},imagesComplete:function(e){a.trigger(a.globals.classType+"_ImagesComplete",e)}}},c=function(){a.globals.customResurrect=function(){},a.globals.customDestroy=function(){}},d=function(e){var r=o.extend({context:"body",usePreloader:!1},e),a=o(r.context);if(1!==a.length)return console.log("Error in generateImgs - context provided is invalid.");var i=new Array,n=new Array;a.find("["+f.imgDataSrc+"]").each(function(){var e=o(this),a=e.attr("src"),a=u(e);e.hasClass(f.imgPreloadClass)&&a&&(r.usePreloader&&h(e),0!==a.indexOf(global.baseUrl)&&(a=global.baseUrl+a),i.push(a),n.push(e)),0});var l=global.siteUrl.length;i.length?o.imgpreload(i,{each:function(e){var t=this;setTimeout(function(){var e=o.inArray(global.baseUrl+t.src.substr(l),i),a=n[e];i.splice(e,1),n.splice(e,1),r.usePreloader&&v(a),o(a).attr("src",t.src),o(a).attr(f.imgDataSrc,""),o(a).attr(f.imgDataSrc2x,"")},f.simulatedDelay)},all:function(){g().imagesComplete()}}):g().imagesComplete()},u=function(e){var a=m.innerWidth||p.documentElement.clientWidth||p.body.clientWidth,t=e.get(0);if(0!==t.length){var r=t.hasAttribute?function(e,a){return e.hasAttribute(a)}:function(e,a){return null!==e.getAttribute(a)},i=(m.devicePixelRatio&&1.2<=m.devicePixelRatio?1:0)&&r(t,f.imgDataSrc2x)?f.imgDataSrc2x:f.imgDataSrc;if(!r(t,i))return!1;for(var n=t.getAttribute(i).split(","),l=0;l<n.length;l++){var o,s,g,c=n[l].split(":"),d=c[0],u=c[1];if(-1!==d.indexOf("<")?(s=d.split("<"),n[l-1]?(o=n[l-1].split(/:(.+)/)[0].split("<"),a<=s[1]&&a>o[1]):a<=s[1]):(s=d.split(">"),n[l+1]?(g=n[l+1].split(/:(.+)/)[0].split(">"),a>=s[1]&&a<g[1]):a>=s[1]))return u}}},h=function(e){var a=o(e);if(1!==a.length)return console.log("Error in addImgPreloaders - context provided is invalid.");if(a.hasClass(f.imgNoPreloadClass))return console.log("No add preload");var t=a.parent("figure");1!==t.children(f.loaderClass).length&&(t.append(f.loaderTemplate),a.hide())},v=function(e){var a=o(e);if(1!==a.length)return console.log("Error in removeImgPreloader - imgEl provided is invalid.");var t=a.parent("figure").children(f.loaderClass);1===t.length&&(t.remove(),a.show())};a.addMethod("init",function(){a.bind(m,a.globals.classType+"_Init",function(e,a,t){i.preloaded=!0,r()})}),r()});