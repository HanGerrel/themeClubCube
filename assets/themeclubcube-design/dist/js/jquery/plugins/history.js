!function(i,r){"use strict";var s=i.console||r,l=i.document,a=i.navigator,o=!1,n=i.setTimeout,u=i.clearTimeout,c=i.setInterval,d=i.clearInterval,p=i.JSON,h=i.alert,g=i.History=i.History||{},f=i.history;try{(o=i.sessionStorage).setItem("TEST","1"),o.removeItem("TEST")}catch(e){o=!1}if(p.stringify=p.stringify||p.encode,p.parse=p.parse||p.decode,void 0!==g.init)throw new Error("History.js Core has already been loaded...");g.init=function(e){return void 0!==g.Adapter&&(void 0!==g.initCore&&g.initCore(),void 0!==g.initHtml4&&g.initHtml4(),!0)},g.initCore=function(e){if(void 0!==g.initCore.initialized)return!1;var t;if(g.initCore.initialized=!0,g.options=g.options||{},g.options.hashChangeInterval=g.options.hashChangeInterval||100,g.options.safariPollInterval=g.options.safariPollInterval||500,g.options.doubleCheckInterval=g.options.doubleCheckInterval||500,g.options.disableSuid=g.options.disableSuid||!1,g.options.storeInterval=g.options.storeInterval||1e3,g.options.busyDelay=g.options.busyDelay||250,g.options.debug=g.options.debug||!1,g.options.initialTitle=g.options.initialTitle||l.title,g.options.html4Mode=g.options.html4Mode||!1,g.options.delayInit=g.options.delayInit||!1,g.intervalList=[],g.clearAllIntervals=function(){var e,t=g.intervalList;if(null!=t){for(e=0;e<t.length;e++)d(t[e]);g.intervalList=null}},g.debug=function(){g.options.debug&&g.log.apply(g,arguments)},g.log=function(){var e,t,r,a,o,n=!(void 0===s||void 0===s.log||void 0===s.log.apply),i=l.getElementById("log");for(n?(e=(a=Array.prototype.slice.call(arguments)).shift(),void 0!==s.debug?s.debug.apply(s,[e,a]):s.log.apply(s,[e,a])):e="\n"+arguments[0]+"\n",t=1,r=arguments.length;t<r;++t){if("object"==typeof(o=arguments[t])&&void 0!==p)try{o=p.stringify(o)}catch(e){}e+="\n"+o+"\n"}return i?(i.value+=e+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):n||h(e),!0},g.getInternetExplorerMajorVersion=function(){return g.getInternetExplorerMajorVersion.cached=void 0!==g.getInternetExplorerMajorVersion.cached?g.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=l.createElement("div"),r=t.getElementsByTagName("i");(t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e")&&r[0];);return 4<e&&e}()},g.isInternetExplorer=function(){return g.isInternetExplorer.cached=void 0!==g.isInternetExplorer.cached?g.isInternetExplorer.cached:Boolean(g.getInternetExplorerMajorVersion())},g.options.html4Mode?g.emulated={pushState:!0,hashChange:!0}:g.emulated={pushState:!Boolean(i.history&&i.history.pushState&&i.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(a.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(a.userAgent))),hashChange:Boolean(!("onhashchange"in i||"onhashchange"in l)||g.isInternetExplorer()&&g.getInternetExplorerMajorVersion()<8)},g.enabled=!g.emulated.pushState,g.bugs={setHash:Boolean(!g.emulated.pushState&&"Apple Computer, Inc."===a.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(a.userAgent)),safariPoll:Boolean(!g.emulated.pushState&&"Apple Computer, Inc."===a.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(a.userAgent)),ieDoubleCheck:Boolean(g.isInternetExplorer()&&g.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(g.isInternetExplorer()&&g.getInternetExplorerMajorVersion()<7)},g.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},g.cloneObject=function(e){var t,r=e?(t=p.stringify(e),p.parse(t)):{};return r},g.getRootUrl=function(){var e=l.location.protocol+"//"+(l.location.hostname||l.location.host);return l.location.port&&(e+=":"+l.location.port),e+="/"},g.getBaseHref=function(){var e=l.getElementsByTagName("base"),t="";return 1===e.length&&(t=e[0].href.replace(/[^\/]+$/,"")),(t=t.replace(/\/+$/,""))&&(t+="/"),t},g.getBaseUrl=function(){return g.getBaseHref()||g.getBasePageUrl()||g.getRootUrl()},g.getPageUrl=function(){return((g.getState(!1,!1)||{}).url||g.getLocationHref()).replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,r){return/\./.test(e)?e:e+"/"})},g.getBasePageUrl=function(){return g.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,r){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/"},g.getFullUrl=function(e,t){var r=e,a=e.substring(0,1);return t=void 0===t||t,/[a-z]+\:\/\//.test(e)||(r="/"===a?g.getRootUrl()+e.replace(/^\/+/,""):"#"===a?g.getPageUrl().replace(/#.*/,"")+e:"?"===a?g.getPageUrl().replace(/[\?#].*/,"")+e:t?g.getBaseUrl()+e.replace(/^(\.\/)+/,""):g.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),r.replace(/\#$/,"")},g.getShortUrl=function(e){var t=e,r=g.getBaseUrl(),a=g.getRootUrl();return g.emulated.pushState&&(t=t.replace(r,"")),t=t.replace(a,"/"),g.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},g.getLocationHref=function(e){return(e=e||l).URL===e.location.href?e.location.href:e.location.href===decodeURIComponent(e.URL)?e.URL:(!e.location.hash||decodeURIComponent(e.location.href.replace(/^[^#]+/,""))!==e.location.hash)&&(-1!=e.URL.indexOf("#")||-1==e.location.href.indexOf("#"))&&e.URL||e.location.href},g.store={},g.idToState=g.idToState||{},g.stateToId=g.stateToId||{},g.urlToId=g.urlToId||{},g.storedStates=g.storedStates||[],g.savedStates=g.savedStates||[],g.normalizeStore=function(){g.store.idToState=g.store.idToState||{},g.store.urlToId=g.store.urlToId||{},g.store.stateToId=g.store.stateToId||{}},g.getState=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var r=g.getLastSavedState();return!r&&t&&(r=g.createStateObject()),e&&((r=g.cloneObject(r)).url=r.cleanUrl||r.url),r},g.getIdByState=function(e){var t,r=g.extractId(e.url);if(!r)if(t=g.getStateString(e),void 0!==g.stateToId[t])r=g.stateToId[t];else if(void 0!==g.store.stateToId[t])r=g.store.stateToId[t];else{for(;r=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),void 0!==g.idToState[r]||void 0!==g.store.idToState[r];);g.stateToId[t]=r,g.idToState[r]=e}return r},g.normalizeState=function(e){var t,r;return e&&"object"==typeof e||(e={}),void 0!==e.normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),(t={normalized:!0}).title=e.title||"",t.url=g.getFullUrl(e.url?e.url:g.getLocationHref()),t.hash=g.getShortUrl(t.url),t.data=g.cloneObject(e.data),t.id=g.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,r=!g.isEmptyObject(t.data),(t.title||r)&&!0!==g.options.disableSuid&&(t.hash=g.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=g.getFullUrl(t.hash),(g.emulated.pushState||g.bugs.safariPoll)&&g.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},g.createStateObject=function(e,t,r){var a={data:e,title:t,url:r};return a=g.normalizeState(a)},g.getStateById=function(e){return e=String(e),g.idToState[e]||g.store.idToState[e]||r},g.getStateString=function(e){var t={data:g.normalizeState(e).data,title:e.title,url:e.url};return p.stringify(t)},g.getStateId=function(e){return g.normalizeState(e).id},g.getHashByState=function(e){return g.normalizeState(e).hash},g.extractId=function(e){var t=-1!=e.indexOf("#")?e.split("#")[0]:e,r=/(.*)\&_suid=([0-9]+)$/.exec(t);r&&r[1];return(r?String(r[2]||""):"")||!1},g.isTraditionalAnchor=function(e){return!/[\/\?\.]/.test(e)},g.extractState=function(e,t){var r,a,o=null;return t=t||!1,(r=g.extractId(e))&&(o=g.getStateById(r)),o||(a=g.getFullUrl(e),(r=g.getIdByUrl(a)||!1)&&(o=g.getStateById(r)),o||!t||g.isTraditionalAnchor(e)||(o=g.createStateObject(null,null,a))),o},g.getIdByUrl=function(e){return g.urlToId[e]||g.store.urlToId[e]||r},g.getLastSavedState=function(){return g.savedStates[g.savedStates.length-1]||r},g.getLastStoredState=function(){return g.storedStates[g.storedStates.length-1]||r},g.hasUrlDuplicate=function(e){var t=g.extractState(e.url);return t&&t.id!==e.id},g.storeState=function(e){return g.urlToId[e.url]=e.id,g.storedStates.push(g.cloneObject(e)),e},g.isLastSavedState=function(e){var t=!1;return g.savedStates.length&&(t=e.id===g.getLastSavedState().id),t},g.saveState=function(e){return!g.isLastSavedState(e)&&(g.savedStates.push(g.cloneObject(e)),!0)},g.getStateByIndex=function(e){return void 0===e?g.savedStates[g.savedStates.length-1]:e<0?g.savedStates[g.savedStates.length+e]:g.savedStates[e]},g.getCurrentIndex=function(){return g.savedStates.length<1?0:g.savedStates.length-1},g.getHash=function(e){var t=g.getLocationHref(e);return g.getHashByUrl(t)},g.unescapeHash=function(e){var t=g.normalizeHash(e);return t=decodeURIComponent(t)},g.normalizeHash=function(e){return e.replace(/[^#]*#/,"").replace(/#.*/,"")},g.setHash=function(e,t){var r,a;return!1!==t&&g.busy()?(g.pushQueue({scope:g,callback:g.setHash,args:arguments,queue:t}),!1):(g.busy(!0),(r=g.extractState(e,!0))&&!g.emulated.pushState?g.pushState(r.data,r.title,r.url,!1):g.getHash()!==e&&(g.bugs.setHash?(a=g.getPageUrl(),g.pushState(null,null,a+"#"+e,!1)):l.location.hash=e),g)},g.escapeHash=function(e){var t=g.normalizeHash(e),t=i.encodeURIComponent(t);return g.bugs.hashEscape||(t=t.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),t},g.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=g.unescapeHash(t)},g.setTitle=function(e){var t,r=e.title;r||(t=g.getStateByIndex(0))&&t.url===e.url&&(r=t.title||g.options.initialTitle);try{l.getElementsByTagName("title")[0].innerHTML=r.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return l.title=r,g},g.queues=[],g.busy=function(e){var a;return void 0!==e?g.busy.flag=e:void 0===g.busy.flag&&(g.busy.flag=!1),g.busy.flag||(u(g.busy.timeout),a=function(){var e,t,r;if(!g.busy.flag)for(e=g.queues.length-1;0<=e;--e)0!==(t=g.queues[e]).length&&(r=t.shift(),g.fireQueueItem(r),g.busy.timeout=n(a,g.options.busyDelay))},g.busy.timeout=n(a,g.options.busyDelay)),g.busy.flag},g.busy.flag=!1,g.fireQueueItem=function(e){return e.callback.apply(e.scope||g,e.args||[])},g.pushQueue=function(e){return g.queues[e.queue||0]=g.queues[e.queue||0]||[],g.queues[e.queue||0].push(e),g},g.queue=function(e,t){return"function"==typeof e&&(e={callback:e}),void 0!==t&&(e.queue=t),g.busy()?g.pushQueue(e):g.fireQueueItem(e),g},g.clearQueue=function(){return g.busy.flag=!1,g.queues=[],g},g.stateChanged=!1,g.doubleChecker=!1,g.doubleCheckComplete=function(){return g.stateChanged=!0,g.doubleCheckClear(),g},g.doubleCheckClear=function(){return g.doubleChecker&&(u(g.doubleChecker),g.doubleChecker=!1),g},g.doubleCheck=function(e){return g.stateChanged=!1,g.doubleCheckClear(),g.bugs.ieDoubleCheck&&(g.doubleChecker=n(function(){return g.doubleCheckClear(),g.stateChanged||e(),!0},g.options.doubleCheckInterval)),g},g.safariStatePoll=function(){var e=g.extractState(g.getLocationHref());if(!g.isLastSavedState(e))return e||g.createStateObject(),g.Adapter.trigger(i,"popstate"),g},g.back=function(e){return!1!==e&&g.busy()?(g.pushQueue({scope:g,callback:g.back,args:arguments,queue:e}),!1):(g.busy(!0),g.doubleCheck(function(){g.back(!1)}),f.go(-1),!0)},g.forward=function(e){return!1!==e&&g.busy()?(g.pushQueue({scope:g,callback:g.forward,args:arguments,queue:e}),!1):(g.busy(!0),g.doubleCheck(function(){g.forward(!1)}),f.go(1),!0)},g.go=function(e,t){var r;if(0<e)for(r=1;r<=e;++r)g.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(r=-1;e<=r;--r)g.back(t)}return g},g.emulated.pushState?(t=function(){},g.pushState=g.pushState||t,g.replaceState=g.replaceState||t):(g.onPopState=function(e,t){var r,a,o,n=!1;return g.doubleCheckComplete(),(a=g.getHash())?((o=g.extractState(a||g.getLocationHref(),!0))?g.replaceState(o.data,o.title,o.url,!1):(g.Adapter.trigger(i,"anchorchange"),g.busy(!1)),g.expectedStateId=!1):(n=(n=(r=g.Adapter.extractEventData("state",e,t)||!1)?g.getStateById(r):g.expectedStateId?g.getStateById(g.expectedStateId):g.extractState(g.getLocationHref()))||g.createStateObject(null,null,g.getLocationHref()),g.expectedStateId=!1,g.isLastSavedState(n)?(g.busy(!1),!1):(g.storeState(n),g.saveState(n),g.setTitle(n),g.Adapter.trigger(i,"statechange"),g.busy(!1),!0))},g.Adapter.bind(i,"popstate",g.onPopState),g.pushState=function(e,t,r,a){if(g.getHashByUrl(r)&&g.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==a&&g.busy())return g.pushQueue({scope:g,callback:g.pushState,args:arguments,queue:a}),!1;g.busy(!0);var o=g.createStateObject(e,t,r);return g.isLastSavedState(o)?g.busy(!1):(g.storeState(o),g.expectedStateId=o.id,f.pushState(o.id,o.title,o.url),g.Adapter.trigger(i,"popstate")),!0},g.replaceState=function(e,t,r,a){if(g.getHashByUrl(r)&&g.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==a&&g.busy())return g.pushQueue({scope:g,callback:g.replaceState,args:arguments,queue:a}),!1;g.busy(!0);var o=g.createStateObject(e,t,r);return g.isLastSavedState(o)?g.busy(!1):(g.storeState(o),g.expectedStateId=o.id,f.replaceState(o.id,o.title,o.url),g.Adapter.trigger(i,"popstate")),!0}),o){try{g.store=p.parse(o.getItem("History.store"))||{}}catch(e){g.store={}}g.normalizeStore()}else g.store={},g.normalizeStore();g.Adapter.bind(i,"unload",g.clearAllIntervals),g.saveState(g.storeState(g.extractState(g.getLocationHref(),!0))),o&&(g.onUnload=function(){var t,e,r;try{t=p.parse(o.getItem("History.store"))||{}}catch(e){t={}}for(e in t.idToState=t.idToState||{},t.urlToId=t.urlToId||{},t.stateToId=t.stateToId||{},g.idToState)g.idToState.hasOwnProperty(e)&&(t.idToState[e]=g.idToState[e]);for(e in g.urlToId)g.urlToId.hasOwnProperty(e)&&(t.urlToId[e]=g.urlToId[e]);for(e in g.stateToId)g.stateToId.hasOwnProperty(e)&&(t.stateToId[e]=g.stateToId[e]);g.store=t,g.normalizeStore(),r=p.stringify(t);try{o.setItem("History.store",r)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;o.length&&(o.removeItem("History.store"),o.setItem("History.store",r))}},g.intervalList.push(c(g.onUnload,g.options.storeInterval)),g.Adapter.bind(i,"beforeunload",g.onUnload),g.Adapter.bind(i,"unload",g.onUnload)),g.emulated.pushState||(g.bugs.safariPoll&&g.intervalList.push(c(g.safariStatePoll,g.options.safariPollInterval)),"Apple Computer, Inc."!==a.vendor&&"Mozilla"!==(a.appCodeName||"")||(g.Adapter.bind(i,"hashchange",function(){g.Adapter.trigger(i,"popstate")}),g.getHash()&&g.Adapter.onDomLoad(function(){g.Adapter.trigger(i,"hashchange")})))},g.options&&g.options.delayInit||g.init()}(window);